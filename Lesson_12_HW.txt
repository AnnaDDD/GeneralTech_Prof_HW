1. Найдите ошибки в след/запросе:

// Увеличить баланс всем юзерам не из Germany на 25%
db.posts.updateOne(
    { country: 'Germany'  },
    { $inc: { balance: .75 } }
)

- не правильно выбрана коллекция (posts вместо users)
- использован метод updateOne, а по условиям задачи баланс нужно изменить всем пользователям
- условие для фильтрации юзеров выбрано неверно
- вместо оператора $inc, который используется для инкрементирования числового значения,  нужно было использовать оператор $mul, чтобы умножить баланс на 1.25 и тем самым увеличить его на 25%.

Правильное решение:

db.users.updateMany(
    { country: { $ne: 'Germany' } },
    { $mul: { balance: 1.25 } }
);


2. Вывести все посты с тегом music

db.posts.aggregate([
    {
        $match: {
            tag: 'music'
        }
    }
]);


3.Опишите назначение оператора $skip (и вход/выход)

Оператор $skip является одним из операторов агрегации в MongoDB и нужен, чтобы пропустить определенное количество документов в начале результатов агрегации.

Пример (Вывести второго пользователя из ТОПа юзеров по размеру баланса):
db.users.aggregate([
    {
        $sort: {
            balance: -1 
        }
    },
    {
        $skip: 1 
    },
    {
        $limit: 1 
    }
]); 

Вход: $skip имеет число в качестве аргумента, которое указывает, сколько документов нужно пропустить. На вход принимает колекцию юзеров, отсортированную по убыванию баланса (в данном примере). 

Выход: Результатом работы $skip является продолжение выборки, начиная с документа, который находится после указанного числа пропущенных документов. В данном примере $skip возвращает уже отсортированную по убыванию баланса колекцию юзеров, за исключением первого документа.


4. Вывести названия постов и имена авторов, которые имеют отрицательный баланс

db.posts.aggregate([
    {
        $lookup: {
            from: "users", 
            localField: "author_id", 
            foreignField: "_id", 
            as: "author" 
        }
    },
    {
        $unwind: "$author" 
    },
    {
        $match: {
            "author.balance": { $lt: 0 } 
        }
    },
    {
        $project: {
            _id: 0,
            post: "$content",
            author: "$author.fullname"
        }
    }
]);


